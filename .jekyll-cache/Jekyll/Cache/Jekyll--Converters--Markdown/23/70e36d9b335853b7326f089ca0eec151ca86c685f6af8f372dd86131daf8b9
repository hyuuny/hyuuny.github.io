I" m<h2 id="interceptor"><span style="color:MediumSeaGreen">Interceptor</span></h2>
<p>ìŠ¤í”„ë§ ì¸í„°ì…‰í„°ë„ ì„œë¸”ë¦¿ í•„í„°ì™€ ê°™ì´ ì›¹ê³¼ ê´€ë ¨ëœ ê³µí†µ ê´€ì‹¬ ì‚¬í•­ì„ íš¨ê³¼ì ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆëŠ” ê¸°ìˆ ì´ë‹¤. ì„œë¸”ë¦¿ í•„í„°ê°€ ì„œë¸”ë¦¿ì´ ì œê³µí•˜ëŠ” ê¸°ìˆ ì´ë¼ë©´, ìŠ¤í”„ë§ ì¸í„°ì…‰í„°ëŠ” ìŠ¤í”„ë§ MVCê°€ ì œê³µí•˜ëŠ” ê¸°ìˆ ì´ë‹¤. ë‘˜ë‹¤ ì›¹ê³¼ ê´€ë ¨ëœ ê³µí†µ ê´€ì‹¬ ì‚¬í•­ì„ ì²˜ë¦¬í•˜ì§€ë§Œ, ì ìš©ë˜ëŠ” ìˆœì„œì™€ ë²”ìœ„, ê·¸ë¦¬ê³  ì‚¬ìš©ë°©ë²•ì´ ë‹¤ë¥´ë‹¤.</p>

<p>ì¸í„°ì…‰í„°ì˜ íë¦„ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP ìš”ì²­ -&gt;WAS-&gt; í•„í„° -&gt; ë””ìŠ¤íŒ¨ì²˜ ì„œë¸”ë¦¿ -&gt; ìŠ¤í”„ë§ ì¸í„°ì…‰í„° -&gt; ì»¨íŠ¸ë¡¤ëŸ¬
</code></pre></div></div>
<ul>
  <li>ìŠ¤í”„ë§ ì¸í„°ì…‰í„°ëŠ” ë””ìŠ¤íŒ¨ì²˜ ì„œë¸”ë¦¿ê³¼ ì»¨íŠ¸ë¡¤ëŸ¬ ì‚¬ì´ì—ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ í˜¸ì¶œ ì§ì „ì— í˜¸ì¶œ ëœë‹¤.</li>
  <li>ìŠ¤í”„ë§ ì¸í„°ì…‰í„°ëŠ” ìŠ¤í”„ë§ MVCê°€ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì´ê¸° ë•Œë¬¸ì— ê²°êµ­ ë””ìŠ¤íŒ¨ì²˜ ì„œë¸”ë¦¿ ì´í›„ì— ë“±ì¥í•˜ê²Œ ëœë‹¤.</li>
</ul>

<p>ì•„ë˜ëŠ” ì¸í„°ì…‰í„°ë¡œ ì œí•œì„ ì ìš©í–ˆì„ ë•Œ, íë¦„ì´ë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP ìš”ì²­ -&gt; WAS -&gt; í•„í„° -&gt; ë””ìŠ¤íŒ¨ì²˜ ì„œë¸”ë¦¿ -&gt; ìŠ¤í”„ë§ ì¸í„°ì…‰í„° -&gt; ì»¨íŠ¸ë¡¤ëŸ¬ //ë¡œê·¸ì¸ ì‚¬ìš©ì
HTTP ìš”ì²­ -&gt; WAS -&gt; í•„í„° -&gt; ë””ìŠ¤íŒ¨ì²˜ ì„œë¸”ë¦¿ -&gt; ìŠ¤í”„ë§ ì¸í„°ì…‰í„°(ì ì ˆí•˜ì§€ ì•Šì€ ìš”ì²­ì´ë¼ íŒë‹¨, ì»¨íŠ¸ë¡¤ëŸ¬ í˜¸ì¶œ X) // ë¯¸ì¸ì¦ ì‚¬ìš©ì
</code></pre></div></div>
<p><br />
ì¸í„°ì…‰í„° ì—­ì‹œ í•„í„°ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì²´ì¸ì„ ì´ìš©í•˜ì—¬ ì—¬ëŸ¬ ê°œì˜ ì¸í„°ì…‰í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP ìš”ì²­ -&gt; WAS -&gt; í•„í„° -&gt; ë””ìŠ¤íŒ¨ì²˜ ì„œë¸”ë¦¿ -&gt; ì¸í„°ì…‰í„°1 -&gt; ì¸í„°ì…‰í„°2 -&gt; ì»¨íŠ¸ë¡¤ëŸ¬
</code></pre></div></div>

<hr />

<h2 id="interceptor-í˜¸ì¶œ-íë¦„"><span style="color:MediumSeaGreen">interceptor í˜¸ì¶œ íë¦„</span></h2>

<p><strong>ì •ìƒ íë¦„</strong>
<img src="/assets/images/spring/interceptor1.png" alt="img.png" /></p>
<ul>
  <li><strong>preHandle</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">ì»¨íŠ¸ë¡¤ëŸ¬ í˜¸ì¶œ ì „ì— í˜¸ì¶œ</code> (ë” ì •í™•íˆëŠ” í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° í˜¸ì¶œ ì „ì— í˜¸ì¶œ)</li>
      <li><code class="language-plaintext highlighter-rouge">preHandle</code> ì˜ ì‘ë‹µê°’ì´ <code class="language-plaintext highlighter-rouge">true</code>ì´ë©´ ë‹¤ìŒìœ¼ë¡œ ì§„í–‰í•˜ê³ , <code class="language-plaintext highlighter-rouge">false</code>ì´ë©´ ë”ëŠ” ì§„í–‰í•˜ì§€ ì•ŠëŠ”ë‹¤. <code class="language-plaintext highlighter-rouge">false</code>
ì¸ ê²½ìš° ë‚˜ë¨¸ì§€ ì¸í„°ì…‰í„°ëŠ” ë¬¼ë¡ ì´ê³ , í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ë„ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤.</li>
    </ul>
  </li>
  <li><strong>postHandle</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">ì»¨íŠ¸ë¡¤ëŸ¬ í˜¸ì¶œ í›„ì— í˜¸ì¶œ</code> (ë” ì •í™•íˆëŠ” í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° í˜¸ì¶œ í›„ì— í˜¸ì¶œ)</li>
    </ul>
  </li>
  <li><strong>afterCompletion</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">ë·°ê°€ ë Œë”ë§ ëœ ì´í›„ì— í˜¸ì¶œ</code></li>
    </ul>
  </li>
</ul>

<p><br /></p>

<p><strong>ì¸í„°ì…‰í„° ì˜ˆì™¸ ìƒí™©</strong> 
<img src="/assets/images/spring/interceptor2.png" alt="img.png" /></p>
<ul>
  <li><strong>preHandle</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">ì»¨íŠ¸ë¡¤ëŸ¬ í˜¸ì¶œ ì „ì— í˜¸ì¶œ</code></li>
    </ul>
  </li>
  <li><strong>postHandle</strong>
    <ul>
      <li>ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ <code class="language-plaintext highlighter-rouge">postHandle</code>ì€ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤.</li>
    </ul>
  </li>
  <li><strong>afterCompletion</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">afterCompletion ì€ í•­ìƒ í˜¸ì¶œ</code></li>
      <li>ì˜ˆì™¸ì™€ ë¬´ê´€í•˜ê²Œ ê³µí†µ ì²˜ë¦¬ë¥¼ í•˜ë ¤ë©´ <code class="language-plaintext highlighter-rouge">afterCompletion()</code>ì„ ì‚¬ìš©</li>
      <li>ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ <code class="language-plaintext highlighter-rouge">afterCompletion()</code>ì— ì˜ˆì™¸ ì •ë³´<code class="language-plaintext highlighter-rouge">( ex )</code>ë¥¼ í¬í•¨í•´ì„œ í˜¸ì¶œëœë‹¤.</li>
      <li>ì´ ê²½ìš° ì˜ˆì™¸( ex )ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ì„œ ì–´ë–¤ ì˜ˆì™¸ê°€ ë°œìƒí–ˆëŠ”ì§€ ë¡œê·¸ë¡œ ì¶œë ¥í•  ìˆ˜ ìˆë‹¤.</li>
    </ul>
  </li>
</ul>

<h2 id="interceptorë¥¼-ì´ìš©í•œ-ë¡œê·¸ì¸-í™•ì¸-ê¸°ëŠ¥-ê°œë°œ"><span style="color:MediumSeaGreen">interceptorë¥¼ ì´ìš©í•œ ë¡œê·¸ì¸ í™•ì¸ ê¸°ëŠ¥ ê°œë°œ</span></h2>

<p>ìŠ¤í”„ë§ì˜ ì¸í„°ì…‰í„°ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ <code class="language-plaintext highlighter-rouge">HandlerInterceptor</code> ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ë©´ ëœë‹¤.</p>

<p><br /></p>

<p><strong>- LogInterceptor í´ë˜ìŠ¤</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.login.web.interceptor</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">ObjectUtils</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.UUID</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletResponse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.extern.slf4j.Slf4j</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.method.HandlerMethod</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.servlet.HandlerInterceptor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.servlet.ModelAndView</span><span class="o">;</span>

<span class="nd">@Slf4j</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LogInterceptor</span> <span class="kd">implements</span> <span class="nc">HandlerInterceptor</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">LOG_ID</span> <span class="o">=</span> <span class="s">"logId"</span><span class="o">;</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">preHandle</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="nc">Object</span> <span class="n">handler</span><span class="o">)</span>
      <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">requestURI</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">();</span>
    <span class="nc">String</span> <span class="n">uuid</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>

    <span class="n">request</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="no">LOG_ID</span><span class="o">,</span> <span class="n">uuid</span><span class="o">);</span> <span class="c1">// afterCompletionì— ë„˜ê¸¸ uuid ì €ì¥</span>

    <span class="c1">// @RequestMapping : HandleMethod</span>
    <span class="c1">// ì •ì  ë¦¬ì†Œì†Œ : ResourceHttpRequestHandler</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">handler</span> <span class="k">instanceof</span> <span class="nc">HandlerMethod</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">HandlerMethod</span> <span class="n">handlerMethod</span> <span class="o">=</span> <span class="o">(</span><span class="nc">HandlerMethod</span><span class="o">)</span> <span class="n">handler</span><span class="o">;</span><span class="c1">// í˜¸ì¶œí•œ ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œì˜ ëª¨ë“  ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆìŒ.</span>
    <span class="o">}</span>

    <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"REQUEST [{}][{}][{}]"</span><span class="o">,</span> <span class="n">uuid</span><span class="o">,</span> <span class="n">requestURI</span><span class="o">,</span> <span class="n">handler</span><span class="o">);</span>
    <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>

  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postHandle</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="nc">Object</span> <span class="n">handler</span><span class="o">,</span>
      <span class="nc">ModelAndView</span> <span class="n">modelAndView</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"postHandle [{}]"</span><span class="o">,</span> <span class="n">modelAndView</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">afterCompletion</span><span class="o">(</span>
      <span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span>
      <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span>
      <span class="nc">Object</span> <span class="n">handler</span><span class="o">,</span>
      <span class="nc">Exception</span> <span class="n">ex</span>
  <span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">requestURI</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">();</span>
    <span class="nc">String</span> <span class="n">uuid</span> <span class="o">=</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span><span class="n">request</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="no">LOG_ID</span><span class="o">);</span> <span class="c1">// preHandleì—ì„œ ë„˜ê¸´ uuid ì–»ê¸°</span>

    <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"RESPONSE [{}][{}][{}]"</span><span class="o">,</span> <span class="n">uuid</span><span class="o">,</span> <span class="n">requestURI</span><span class="o">,</span> <span class="n">handler</span><span class="o">);</span>

    <span class="k">if</span> <span class="o">(!</span><span class="n">isEmpty</span><span class="o">(</span><span class="n">ex</span><span class="o">))</span> <span class="o">{</span>
      <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"afterCompletion error!!"</span><span class="o">,</span> <span class="n">ex</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<ul>
  <li><strong>request.setAttribute(LOG_ID, uuid)</strong>
    <ul>
      <li>ì„œë¸”ë¦¿ í•„í„°ì˜ ê²½ìš° ì§€ì—­ë³€ìˆ˜ë¡œ í•´ê²°ì´ ê°€ëŠ¥í•˜ì§€ë§Œ, ìŠ¤í”„ë§ ì¸í„°ì…‰í„°ëŠ” í˜¸ì¶œ ì‹œì ì´ ì™„ì „íˆ ë¶„ë¦¬ë˜ì–´ ìˆë‹¤.</li>
      <li>ë”°ë¼ì„œ <code class="language-plaintext highlighter-rouge">preHandle</code>ì—ì„œ ì§€ì •í•œ ê°’ì„ <code class="language-plaintext highlighter-rouge">postHandle</code>, <code class="language-plaintext highlighter-rouge">afterCompletion</code>ì—ì„œ í•¨ê»˜ ì‚¬ìš©í•˜ë ¤ë©´ ì–´ë”˜ê°€ì— ë‹´ì•„ë‘ì–´ì•¼ í•œë‹¤.</li>
      <li><code class="language-plaintext highlighter-rouge">LogInterceptor</code>ë„ ì‹±ê¸€í†¤ ì²˜ëŸ¼ ì‚¬ìš©ë˜ê¸° ë•Œë¬¸ì— ë§´ë²„ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ìœ„í—˜í•˜ë‹¤.</li>
    </ul>
  </li>
  <li><strong>return true</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">true</code>ë©´ ì •ìƒ í˜¸ì¶œ</li>
      <li>ë‹¤ìŒ ì¸í„°ì…‰í„°ë‚˜ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ í˜¸ì¶œëœë‹¤.</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<p><strong>HandlerMethod</strong><br />
í•¸ë“¤ëŸ¬ ì •ë³´ëŠ” ì–´ë–¤ í•¸ë“¤ëŸ¬ ë§¤í•‘ì„ ì‚¬ìš©í•˜ëŠ”ì§€ì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤.<br />
ìŠ¤í”„ë§ì„ ì‚¬ìš©í•˜ë©´ ì¼ë°˜ì ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">@Controller</code>, <code class="language-plaintext highlighter-rouge">@RequestMapping</code>ì„ í™œìš©í•œ í•¸ë“¤ëŸ¬ ë§¤í•‘ì„ ì‚¬ìš©í•˜ëŠ”ë°, ì´ ê²½ìš° í•¸ë“¤ëŸ¬ ì •ë³´ë¡œ <code class="language-plaintext highlighter-rouge">HandlerMethod</code>ê°€ ë„˜ì–´ì˜¨ë‹¤.</p>

<p><strong>ResourceHttpRequestHandler</strong><br />
<code class="language-plaintext highlighter-rouge">@Controller</code>ê°€ ì•„ë‹ˆë¼ <code class="language-plaintext highlighter-rouge">/resources/static</code>ê³¼ ê°™ì€ ì •ì  ë¦¬ì†ŒìŠ¤ê°€ í˜¸ì¶œ ë˜ëŠ” ê²½ìš°, <code class="language-plaintext highlighter-rouge">ResourceHttpRequestHandler</code>ê°€ í•¸ë“¤ëŸ¬ ì •ë³´ë¡œ ë„˜ì–´ì˜¤ê¸° ë•Œë¬¸ì— íƒ€ì…ì— ë”°ë¼ì„œ ì²˜ë¦¬ê°€ í•„ìš”í•˜ë‹¤.</p>

<hr />

<p><strong>- LoginCheckInterceptor í´ë˜ìŠ¤</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.login.web.interceptor</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">ObjectUtils</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.login.web.SessionConst</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletResponse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.extern.slf4j.Slf4j</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.servlet.HandlerInterceptor</span><span class="o">;</span>

<span class="nd">@Slf4j</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoginCheckInterceptor</span> <span class="kd">implements</span> <span class="nc">HandlerInterceptor</span> <span class="o">{</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">preHandle</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="nc">Object</span> <span class="n">handler</span><span class="o">)</span>
      <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>

    <span class="nc">String</span> <span class="n">requestURI</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">();</span>
    <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"ì¸ì¦ ì²´í¬ ì¸í„°ì…‰í„° ì‹¤í–‰ {}"</span><span class="o">,</span> <span class="n">requestURI</span><span class="o">);</span>

    <span class="cm">/**
     * filterëŠ” ì¸ì¦ì´ í•„ìš”ì—†ëŠ” resourceì˜ ê²½ìš°,
     * String[] whiteList = {"/", "/members/add", "/login", "/logout", "/css/*"}ë¥¼ ì‚¬ìš©í•˜ì—¬ ì²˜ë¦¬í–ˆì§€ë§Œ,
     * interceptorëŠ” @Configurationìœ¼ë¡œ ì„¤ì • ê°€ëŠ¥
     */</span>
    <span class="nc">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">isEmpty</span><span class="o">(</span><span class="n">session</span><span class="o">)</span> <span class="o">||</span> <span class="n">isEmpty</span><span class="o">(</span><span class="n">session</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="nc">SessionConst</span><span class="o">.</span><span class="na">LOGIN_MEMBER</span><span class="o">)))</span> <span class="o">{</span>
      <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"ë¯¸ì¸ì¦ ì‚¬ìš©ì ìš”ì²­"</span><span class="o">);</span>
      <span class="n">response</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="s">"/login?redirectURL="</span> <span class="o">+</span> <span class="n">requestURI</span><span class="o">);</span>
      <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
  <span class="o">}</span>

<span class="o">}</span>

</code></pre></div></div>
<ul>
  <li>ì„œë¸”ë¦¿ í•„í„°ì™€ ë¹„êµí•´ì„œ ì½”ë“œê°€ ë§¤ìš° ê°„ê²°í•˜ë‹¤.</li>
  <li>ì¸ì¦ì´ë¼ëŠ” ê²ƒì€ ì»¨íŠ¸ë¡¤ëŸ¬ í˜¸ì¶œ ì „ì—ë§Œ í˜¸ì¶œë˜ë©´ ëœë‹¤. ë”°ë¼ì„œ <code class="language-plaintext highlighter-rouge">preHandle</code>ë§Œ êµ¬í˜„í•˜ë©´ ëœë‹¤.</li>
</ul>

<hr />

<p><strong>- WebConifg í´ë˜ìŠ¤</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.login</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.login.web.agumentresolver.LoginMemberArgumentResolver</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.login.web.interceptor.LogInterceptor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.login.web.interceptor.LoginCheckInterceptor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Configuration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.method.support.HandlerMethodArgumentResolver</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.servlet.config.annotation.InterceptorRegistry</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.servlet.config.annotation.WebMvcConfigurer</span><span class="o">;</span>

<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebConfig</span> <span class="kd">implements</span> <span class="nc">WebMvcConfigurer</span> <span class="o">{</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addArgumentResolvers</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">HandlerMethodArgumentResolver</span><span class="o">&gt;</span> <span class="n">resolvers</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">resolvers</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">LoginMemberArgumentResolver</span><span class="o">());</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addInterceptors</span><span class="o">(</span><span class="nc">InterceptorRegistry</span> <span class="n">registry</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">registry</span><span class="o">.</span><span class="na">addInterceptor</span><span class="o">(</span><span class="k">new</span> <span class="nc">LogInterceptor</span><span class="o">())</span>
        <span class="o">.</span><span class="na">order</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
        <span class="o">.</span><span class="na">addPathPatterns</span><span class="o">(</span><span class="s">"/**"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">excludePathPatterns</span><span class="o">(</span><span class="s">"/css/**"</span><span class="o">,</span> <span class="s">"/*.ico"</span><span class="o">,</span> <span class="s">"/error"</span><span class="o">);</span>

    <span class="n">registry</span><span class="o">.</span><span class="na">addInterceptor</span><span class="o">(</span><span class="k">new</span> <span class="nc">LoginCheckInterceptor</span><span class="o">())</span>
        <span class="o">.</span><span class="na">order</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
        <span class="o">.</span><span class="na">addPathPatterns</span><span class="o">(</span><span class="s">"/**"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">excludePathPatterns</span><span class="o">(</span>
            <span class="s">"/"</span><span class="o">,</span> <span class="s">"/members/add"</span><span class="o">,</span> <span class="s">"/login"</span><span class="o">,</span> <span class="s">"/logout"</span><span class="o">,</span> <span class="s">"/css/**"</span><span class="o">,</span> <span class="s">"/*.ico"</span><span class="o">,</span> <span class="s">"/error"</span><span class="o">);</span>
  <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">WebMvcConfigurer</code>ê°€ ì œê³µí•˜ëŠ” <code class="language-plaintext highlighter-rouge">addInterceptors()</code>ë¥¼ ì‚¬ìš©í•´ì„œ ì¸í„°ì…‰í„°ë¥¼ ë“±ë¡í•  ìˆ˜ ìˆë‹¤.</p>

<ul>
  <li><strong>registry.addInterceptor()</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">ì¸í„°ì…‰í„°ë¥¼ ë“±ë¡</code></li>
    </ul>
  </li>
  <li><strong>order()</strong>
    <ul>
      <li>ì¸í„°ì…‰í„°ëŠ” ì²´ì¸ìœ¼ë¡œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì—, ìˆœì„œê°€ í•„ìš”(ë‚®ì„ìˆ˜ë¡ ë¨¼ì € ë™ì‘)</li>
      <li><code class="language-plaintext highlighter-rouge">LogInterceptor</code>ê°€ ë¨¼ì € ì ìš©ë˜ê³ , <code class="language-plaintext highlighter-rouge">LoginCheckInterceptor</code>ê°€ ì ìš©ëœë‹¤.</li>
    </ul>
  </li>
  <li><strong>addPathPatterns(â€œ/</strong>â€)**
    <ul>
      <li>ì¸í„°ì…‰í„°ë¥¼ ì ìš©í•  URL íŒ¨í„´ì„ ì§€ì •</li>
    </ul>
  </li>
  <li><strong>excludePathPatterns(â€œ/css/</strong>â€, â€œ/*.icoâ€, â€œ/errorâ€)**
    <ul>
      <li>ì¸í„°ì…‰í„°ì—ì„œ ì œì™¸í•  íŒ¨í„´ì„ ì§€ì •í•œë‹¤.</li>
    </ul>
  </li>
</ul>

<hr />

<p><strong>- LoginController í´ë˜ìŠ¤</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"/login"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">login</span><span class="o">(</span>
      <span class="nd">@Valid</span> <span class="nd">@ModelAttribute</span><span class="o">(</span><span class="s">"loginForm"</span><span class="o">)</span> <span class="nc">LoginForm</span> <span class="n">form</span><span class="o">,</span>
      <span class="nc">BindingResult</span> <span class="n">bindingResult</span><span class="o">,</span>
      <span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span>
      <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"/"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">redirectURL</span>
  <span class="o">)</span> <span class="o">{</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">bindingResult</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
      <span class="k">return</span> <span class="s">"login/loginForm"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nc">Member</span> <span class="n">loginMember</span> <span class="o">=</span> <span class="n">loginService</span><span class="o">.</span><span class="na">login</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getLoginId</span><span class="o">(),</span> <span class="n">form</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">isEmpty</span><span class="o">(</span><span class="n">loginMember</span><span class="o">))</span> <span class="o">{</span>
      <span class="n">bindingResult</span><span class="o">.</span><span class="na">reject</span><span class="o">(</span><span class="s">"loginFail"</span><span class="o">,</span> <span class="s">"ì•„ì´ë”” ë˜ëŠ” íŒ¨ìŠ¤ì›Œë“œê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤."</span><span class="o">);</span>
      <span class="k">return</span> <span class="s">"login/loginForm"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nc">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
    <span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="nc">SessionConst</span><span class="o">.</span><span class="na">LOGIN_MEMBER</span><span class="o">,</span> <span class="n">loginMember</span><span class="o">);</span>

    <span class="k">return</span> <span class="s">"redirect:"</span> <span class="o">+</span> <span class="n">redirectURL</span><span class="o">;</span>
  <span class="o">}</span>
</code></pre></div></div>
<ul>
  <li><strong>return â€œredirect:â€ + redirectURL;</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">LoginCheckFilter</code>ì—ì„œ ë¯¸ì¸ì¦ ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ì„ ì„±ê³µì ìœ¼ë¡œ ë§ˆì¹œ ë’¤, ì›ë˜ í˜ì´ì§€ë¡œ <code class="language-plaintext highlighter-rouge">redirect</code> ì‹œí‚¤ê¸° ìœ„í•¨</li>
    </ul>
  </li>
</ul>

<hr />

<p>ë¡œê·¸ì¸ í™•ì¸ê³¼ ê°™ì´ ë°˜ë³µë˜ëŠ” ì‘ì—…ì„ ì„œë¸”ë¦¿ í•„í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì²˜ë¦¬í•œë‹¤ë©´, <code class="language-plaintext highlighter-rouge">SOLIDì˜ ë‹¨ì¼ì±…ì„ì›ì¹™</code>ì„ ìœ„ë°°í•˜ì§€ ì•Šê³ , í–¥í›„ ë¡œê·¸ì¸ ê´€ë ¨ëœ ì •ì±…ì´ ë³€ê²½ë˜ë”ë¼ë„ ì´ ë¶€ë¶„ë§Œ ìˆ˜ì •í•˜ë©´ ë  ê²ƒì´ë‹¤.</p>
:ET